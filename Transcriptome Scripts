



#Linear regression created by Grace Coppinger
Sample<- read_csv("/Users/gracecoppinger/Desktop/Tsirt_samples.csv")

#The following is an example from just 3FTx. I repeated this script with al major toxin families and the average toxin expressions as well.
# Perform linear regression
M_lm_model_3FTx <- lm(Avg_3FTx ~ SVL, data = Sample, subset = Sex == "M")
F_lm_model_3FTx <- lm(Avg_3FTx ~ SVL, data = Sample, subset = Sex == "F")

# Extract R-squared value and p-value
F_r_squared_3FTx <- summary(F_lm_model_3FTx)$r.squared
F_r_squared_3FTx
F_p_value_3FTx <- summary(F_lm_model_3FTx)$coefficients[2,4]
F_p_value_3FTx
M_r_squared_3FTx <- summary(M_lm_model_3FTx)$r.squared
M_r_squared_3FTx
M_p_value_3FTx <- summary(M_lm_model_3FTx)$coefficients[2,4]
M_p_value_3FTx

# Create scatter plot with linear regression line
FTx_plot <- ggplot(data=Sample, aes(x=SVL, y=Ftxed, colour=Sex)) +
  geom_point() +
  geom_smooth(method = "glm", se = FALSE) + theme_bw() +
  labs(y = "3FTx Transcripts > 500", x= "Snout Vent Length(cm)") + 
  scale_color_manual(values=c("#d30b94", "#2f2aa0"))
FTx_plot
